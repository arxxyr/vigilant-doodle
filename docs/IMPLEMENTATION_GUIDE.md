# Vigilant Doodle - å®æ–½æŒ‡å—

## ğŸ“‹ æ–‡æ¡£ä½“ç³»æ€»è§ˆ

æœ¬é¡¹ç›®é‡‡ç”¨ä¸‰å±‚æ–‡æ¡£æ¶æ„ï¼Œä»å®è§‚åˆ°å¾®è§‚å¼•å¯¼å¼€å‘ï¼š

```
1. WORKSPACE_ARCHITECTURE.md    â†’ é¡¹ç›®ç»„ç»‡ç»“æ„ï¼ˆå®è§‚ï¼‰
2. ARCHITECTURE_BEST_PRACTICE.md â†’ æ¸¸æˆé€»è¾‘æ¶æ„ï¼ˆä¸­è§‚ï¼‰
3. README.md                     â†’ å¿«é€Ÿå‚è€ƒæ‰‹å†Œï¼ˆå¾®è§‚ï¼‰
```

---

## ğŸš€ å®æ–½æ­¥éª¤æ€»è§ˆ

### é˜¶æ®µ 0ï¼šå‡†å¤‡å·¥ä½œï¼ˆå·²å®Œæˆ âœ…ï¼‰
- [x] è®¾è®¡ Workspace æ¶æ„
- [x] è®¾è®¡æ¸¸æˆé€»è¾‘æ¶æ„
- [x] æ•´ç†æ–‡æ¡£ä½“ç³»

### é˜¶æ®µ 1ï¼šåˆ›å»º Workspace ç»“æ„ï¼ˆ0.5 å°æ—¶ï¼‰
- [ ] åˆ é™¤ç°æœ‰ `src/` ç›®å½•
- [ ] åˆ›å»º `crates/launcher` å’Œ `crates/game`
- [ ] ä¿®æ”¹æ ¹ `Cargo.toml` ä¸º workspace é…ç½®
- [ ] éªŒè¯ç¼–è¯‘é€šè¿‡

### é˜¶æ®µ 2ï¼šå®ç°æ ¸å¿ƒæ¶æ„ï¼ˆ2-3 å°æ—¶ï¼‰
- [ ] å®ç° `core/state.rs`ï¼ˆçŠ¶æ€æœºï¼‰
- [ ] å®ç° `assets/loader.rs`ï¼ˆèµ„æºåŠ è½½ï¼‰
- [ ] å®ç° `camera/isometric.rs`ï¼ˆæ–œå‘ä¿¯è§†ç›¸æœºï¼‰
- [ ] å®ç° `world/spawning.rs`ï¼ˆå®ä½“ç”Ÿæˆï¼‰
- [ ] éªŒè¯ï¼šLoading â†’ MainMenu è½¬æ¢æ­£å¸¸

### é˜¶æ®µ 3ï¼šå®ç°æ¸¸æˆç©æ³•ï¼ˆ1-2 å°æ—¶ï¼‰
- [ ] å®ç° `gameplay/player.rs`ï¼ˆç©å®¶ç§»åŠ¨ï¼‰
- [ ] å®ç° `gameplay/enemy.rs`ï¼ˆæ•Œäºº AIï¼‰
- [ ] å®ç° `gameplay/movement.rs`ï¼ˆç¢°æ’æ£€æµ‹ï¼‰
- [ ] å®ç° `input/actions.rs`ï¼ˆè¾“å…¥æ˜ å°„ï¼‰
- [ ] éªŒè¯ï¼šç©å®¶ç§»åŠ¨ã€æ•Œäººè¿½é€æ­£å¸¸

### é˜¶æ®µ 4ï¼šå®ç° UI ç³»ç»Ÿï¼ˆ1-2 å°æ—¶ï¼‰
- [ ] å®ç° `ui/menu/overlay.rs`ï¼ˆæ¨¡ç³Šé®ç½©ï¼‰
- [ ] å®ç° `ui/menu/main_menu.rs`ï¼ˆä¸»èœå•ï¼‰
- [ ] å®ç° `ui/menu/settings_menu.rs`ï¼ˆè®¾ç½®èœå•ï¼‰
- [ ] å®ç° `input/cursor.rs`ï¼ˆå…‰æ ‡ç®¡ç†ï¼‰
- [ ] éªŒè¯ï¼šèœå•æ˜¾ç¤ºã€æŒ‰é’®äº¤äº’æ­£å¸¸

### é˜¶æ®µ 5ï¼šå®Œå–„åŠŸèƒ½ï¼ˆ1 å°æ—¶ï¼‰
- [ ] å®ç° `audio/manager.rs`ï¼ˆéŸ³é¢‘æ’­æ”¾ï¼‰
- [ ] å®ç° `ui/hud/`ï¼ˆæ¸¸æˆå†… HUDï¼Œå¯é€‰ï¼‰
- [ ] æ€§èƒ½æµ‹è¯•ä¸ä¼˜åŒ–
- [ ] ä»£ç å®¡æŸ¥ä¸æ¸…ç†

### é˜¶æ®µ 6ï¼šæ–‡æ¡£ä¸å‘å¸ƒï¼ˆ0.5 å°æ—¶ï¼‰
- [ ] æ›´æ–° README.md
- [ ] æ›´æ–° CLAUDE.md
- [ ] æµ‹è¯• CI/CD æµç¨‹
- [ ] åˆ›å»º Git tag

**æ€»é¢„ä¼°æ—¶é—´ï¼š6-9 å°æ—¶**

---

## ğŸ“ å®Œæ•´æ–‡ä»¶æ¸…å•

### Workspace æ ¹ç›®å½•
```
vigilant-doodle/
â”œâ”€â”€ Cargo.toml                      # âš™ï¸ Workspace é…ç½®ï¼ˆéœ€åˆ›å»ºï¼‰
â”œâ”€â”€ Cargo.lock
â”œâ”€â”€ .cargo/
â”‚   â””â”€â”€ config.toml                 # æ„å»ºé…ç½®ï¼ˆå·²å­˜åœ¨ï¼‰
â”œâ”€â”€ README.md                       # é¡¹ç›®è¯´æ˜ï¼ˆéœ€æ›´æ–°ï¼‰
â””â”€â”€ CLAUDE.md                       # Claude æŒ‡ä»¤ï¼ˆéœ€æ›´æ–°ï¼‰
```

### å¯åŠ¨å™¨ Crate
```
crates/launcher/
â”œâ”€â”€ Cargo.toml                      # ä¾èµ–é…ç½®
â””â”€â”€ src/
    â””â”€â”€ main.rs                     # å¯åŠ¨å…¥å£ï¼ˆ~100 è¡Œï¼‰
```

### æ¸¸æˆ Crate
```
crates/game/
â”œâ”€â”€ Cargo.toml                      # ä¾èµ–é…ç½®
â””â”€â”€ src/
    â”œâ”€â”€ lib.rs                      # æ’ä»¶æ³¨å†Œï¼ˆ~100 è¡Œï¼‰
    â”‚
    â”œâ”€â”€ core/                       # æ ¸å¿ƒç³»ç»Ÿ
    â”‚   â”œâ”€â”€ mod.rs
    â”‚   â”œâ”€â”€ state.rs                # çŠ¶æ€æœºï¼ˆ~80 è¡Œï¼‰
    â”‚   â””â”€â”€ settings.rs             # æ¸¸æˆè®¾ç½®ï¼ˆ~50 è¡Œï¼‰
    â”‚
    â”œâ”€â”€ assets/                     # èµ„æºç®¡ç†
    â”‚   â”œâ”€â”€ mod.rs
    â”‚   â””â”€â”€ loader.rs               # èµ„æºåŠ è½½ï¼ˆ~60 è¡Œï¼‰
    â”‚
    â”œâ”€â”€ camera/                     # ç›¸æœºç³»ç»Ÿ
    â”‚   â”œâ”€â”€ mod.rs
    â”‚   â”œâ”€â”€ isometric.rs            # æ–œå‘ä¿¯è§†ç›¸æœºï¼ˆ~120 è¡Œï¼‰
    â”‚   â””â”€â”€ components.rs           # ç»„ä»¶å®šä¹‰ï¼ˆ~30 è¡Œï¼‰
    â”‚
    â”œâ”€â”€ gameplay/                   # æ¸¸æˆç©æ³•
    â”‚   â”œâ”€â”€ mod.rs
    â”‚   â”œâ”€â”€ player.rs               # ç©å®¶é€»è¾‘ï¼ˆ~80 è¡Œï¼‰
    â”‚   â”œâ”€â”€ enemy.rs                # æ•Œäºº AIï¼ˆ~80 è¡Œï¼‰
    â”‚   â””â”€â”€ movement.rs             # ç¢°æ’æ£€æµ‹ï¼ˆ~50 è¡Œï¼‰
    â”‚
    â”œâ”€â”€ world/                      # ä¸–ç•Œç®¡ç†
    â”‚   â”œâ”€â”€ mod.rs
    â”‚   â”œâ”€â”€ spawning.rs             # å®ä½“ç”Ÿæˆï¼ˆ~120 è¡Œï¼‰
    â”‚   â””â”€â”€ terrain.rs              # åœ°å½¢ç”Ÿæˆï¼ˆ~50 è¡Œï¼‰
    â”‚
    â”œâ”€â”€ ui/                         # UI ç³»ç»Ÿ
    â”‚   â”œâ”€â”€ mod.rs
    â”‚   â”œâ”€â”€ menu/
    â”‚   â”‚   â”œâ”€â”€ mod.rs
    â”‚   â”‚   â”œâ”€â”€ overlay.rs          # æ¨¡ç³Šé®ç½©ï¼ˆ~50 è¡Œï¼‰
    â”‚   â”‚   â”œâ”€â”€ main_menu.rs        # ä¸»èœå•ï¼ˆ~150 è¡Œï¼‰
    â”‚   â”‚   â””â”€â”€ settings_menu.rs    # è®¾ç½®èœå•ï¼ˆ~200 è¡Œï¼‰
    â”‚   â”œâ”€â”€ hud/
    â”‚   â”‚   â”œâ”€â”€ mod.rs
    â”‚   â”‚   â”œâ”€â”€ health_bar.rs       # è¡€æ¡ï¼ˆå¯é€‰ï¼‰
    â”‚   â”‚   â””â”€â”€ score.rs            # åˆ†æ•°ï¼ˆå¯é€‰ï¼‰
    â”‚   â””â”€â”€ styles.rs               # UI æ ·å¼ï¼ˆ~50 è¡Œï¼‰
    â”‚
    â”œâ”€â”€ input/                      # è¾“å…¥ç®¡ç†
    â”‚   â”œâ”€â”€ mod.rs
    â”‚   â”œâ”€â”€ actions.rs              # è¾“å…¥æ˜ å°„ï¼ˆ~80 è¡Œï¼‰
    â”‚   â””â”€â”€ cursor.rs               # å…‰æ ‡ç®¡ç†ï¼ˆ~80 è¡Œï¼‰
    â”‚
    â””â”€â”€ audio/                      # éŸ³é¢‘ç³»ç»Ÿ
        â”œâ”€â”€ mod.rs
        â””â”€â”€ manager.rs              # éŸ³é¢‘æ’­æ”¾ï¼ˆ~60 è¡Œï¼‰
```

**æ€»ä»£ç é‡é¢„ä¼°ï¼š~1600 è¡Œ**ï¼ˆä¸å«ç©ºè¡Œå’Œæ³¨é‡Šï¼‰

---

## ğŸ”§ å…³é”®å‘½ä»¤é€ŸæŸ¥

### å¼€å‘æ¨¡å¼ï¼ˆåŠ¨æ€é“¾æ¥ï¼Œå¿«é€Ÿç¼–è¯‘ï¼‰
```bash
# è¿è¡Œæ¸¸æˆ
cargo run --features dev

# æˆ–è€…æŒ‡å®š package
cargo run -p vigilant-doodle-launcher --features dev
```

### å‘å¸ƒæ¨¡å¼ï¼ˆé™æ€é“¾æ¥ï¼Œå®Œå…¨ä¼˜åŒ–ï¼‰
```bash
# æ„å»ºå‘å¸ƒç‰ˆæœ¬
cargo build --release -p vigilant-doodle-launcher

# æ„å»ºæ‰€æœ‰ crate
cargo build --release --workspace
```

### ä»£ç æ£€æŸ¥
```bash
# æ ¼å¼åŒ–
cargo fmt --all

# Clippy æ£€æŸ¥
cargo clippy --workspace -- -D warnings

# æ£€æŸ¥ç¼–è¯‘ï¼ˆä¸ç”ŸæˆäºŒè¿›åˆ¶ï¼‰
cargo check --workspace
```

### Workspace æ“ä½œ
```bash
# æ¸…ç†æ‰€æœ‰æ„å»ºäº§ç‰©
cargo clean

# ä»…ç¼–è¯‘æ¸¸æˆåº“
cargo build -p vigilant-doodle-game

# æµ‹è¯•æ‰€æœ‰ crate
cargo test --workspace
```

---

## ğŸ“Š å®æ–½è¿›åº¦è¿½è¸ª

### æ£€æŸ¥ç‚¹ 1ï¼šWorkspace ç»“æ„åˆ›å»ºå®Œæˆ
**éªŒè¯æ ‡å‡†**ï¼š
- [ ] `cargo build --workspace` ç¼–è¯‘é€šè¿‡
- [ ] `cargo run` èƒ½å¯åŠ¨çª—å£
- [ ] æ§åˆ¶å°è¾“å‡º `[Game] Loading game plugin...`

### æ£€æŸ¥ç‚¹ 2ï¼šæ ¸å¿ƒæ¶æ„å®ç°å®Œæˆ
**éªŒè¯æ ‡å‡†**ï¼š
- [ ] çª—å£æ˜¾ç¤º Loading çŠ¶æ€ï¼ˆèƒŒæ™¯è‰²ï¼‰
- [ ] 1-2 ç§’åè‡ªåŠ¨è½¬æ¢åˆ° MainMenu çŠ¶æ€
- [ ] æ§åˆ¶å°è¾“å‡ºçŠ¶æ€è½¬æ¢æ—¥å¿—

### æ£€æŸ¥ç‚¹ 3ï¼šæ¸¸æˆç©æ³•å®ç°å®Œæˆ
**éªŒè¯æ ‡å‡†**ï¼š
- [ ] ç©å®¶å¯ä»¥é€šè¿‡ WASD ç§»åŠ¨
- [ ] ç›¸æœºå¹³æ»‘è·Ÿéšç©å®¶
- [ ] æ•Œäººè¿½é€ç©å®¶
- [ ] ç¢°æ’æ£€æµ‹ç”Ÿæ•ˆï¼ˆå®ä½“ä¸ç©¿è¶Šè¾¹ç•Œï¼‰

### æ£€æŸ¥ç‚¹ 4ï¼šUI ç³»ç»Ÿå®ç°å®Œæˆ
**éªŒè¯æ ‡å‡†**ï¼š
- [ ] MainMenu çŠ¶æ€æ˜¾ç¤ºæ¨¡ç³ŠèƒŒæ™¯ + èœå•
- [ ] æŒ‰é’®äº¤äº’æ­£å¸¸ï¼ˆæ‚¬åœã€ç‚¹å‡»ï¼‰
- [ ] ç‚¹å‡» "New Game" è¿›å…¥ Playing çŠ¶æ€
- [ ] æŒ‰ ESC è¿”å›èœå•

### æ£€æŸ¥ç‚¹ 5ï¼šåŠŸèƒ½å®Œå–„
**éªŒè¯æ ‡å‡†**ï¼š
- [ ] éŸ³é¢‘æ’­æ”¾æ­£å¸¸
- [ ] å¸§ç‡ç¨³å®š 60 FPS
- [ ] æ— ç¼–è¯‘è­¦å‘Š
- [ ] æ‰€æœ‰æ–‡æ¡£æ›´æ–°å®Œæˆ

---

## âš ï¸ å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ

### é—®é¢˜ 1ï¼šç¼–è¯‘æ—¶æ‰¾ä¸åˆ° `vigilant-doodle-game`
**åŸå› **ï¼šWorkspace é…ç½®é”™è¯¯æˆ–è·¯å¾„ä¸å¯¹

**è§£å†³**ï¼š
```bash
# æ£€æŸ¥ Workspace æˆå‘˜
cargo metadata --format-version=1 | jq '.workspace_members'

# ç¡®ä¿æ ¹ Cargo.toml åŒ…å«ï¼š
[workspace]
members = ["crates/launcher", "crates/game"]
```

### é—®é¢˜ 2ï¼šåŠ¨æ€é“¾æ¥å¤±è´¥ï¼ˆWindowsï¼‰
**åŸå› **ï¼šWindows å¯¹ dylib æ”¯æŒæœ‰é™

**è§£å†³**ï¼š
- å¼€å‘æ¨¡å¼ä½¿ç”¨ `--features dev`
- å‘å¸ƒæ¨¡å¼ä¸ä½¿ç”¨ dev featureï¼ˆè‡ªåŠ¨é™æ€é“¾æ¥ï¼‰

### é—®é¢˜ 3ï¼šèµ„æºè·¯å¾„æ‰¾ä¸åˆ°
**åŸå› **ï¼šå·¥ä½œç›®å½•ä¸åœ¨ workspace æ ¹ç›®å½•

**è§£å†³**ï¼š
```rust
// ç¡®ä¿ä» workspace æ ¹ç›®å½•è¿è¡Œ
// æˆ–è€…åœ¨ Cargo.toml ä¸­è®¾ç½®ï¼š
[[bin]]
path = "src/main.rs"
test = false
```

### é—®é¢˜ 4ï¼šå¤šä¸ª crate ç‰ˆæœ¬å†²çª
**åŸå› **ï¼šæ²¡æœ‰ä½¿ç”¨ workspace dependencies

**è§£å†³**ï¼š
```toml
# æ ¹ Cargo.toml
[workspace.dependencies]
bevy = { version = "0.17.2", ... }

# å­ crate Cargo.toml
[dependencies]
bevy = { workspace = true, features = [...] }
```

---

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–å»ºè®®

### ç¼–è¯‘é€Ÿåº¦ä¼˜åŒ–
1. **å¯ç”¨ mold/lld é“¾æ¥å™¨**ï¼ˆ.cargo/config.toml å·²é…ç½®ï¼‰
2. **ä½¿ç”¨ sccache**ï¼ˆå¯é€‰ï¼‰ï¼š
   ```bash
   cargo install sccache
   export RUSTC_WRAPPER=sccache
   ```
3. **å¢åŠ å¹¶è¡Œç¼–è¯‘**ï¼š
   ```bash
   export CARGO_BUILD_JOBS=8
   ```

### è¿è¡Œæ—¶æ€§èƒ½ä¼˜åŒ–
1. **Release æ¨¡å¼å¯ç”¨ LTO**ï¼ˆå·²é…ç½®ï¼‰
2. **ä½¿ç”¨ `--target-cpu=native`**ï¼ˆéœ€è¦æ—¶ï¼‰
3. **Profile åˆ†æ**ï¼š
   ```bash
   cargo install flamegraph
   cargo flamegraph --release
   ```

---

## ğŸ¯ ä¸‹ä¸€æ­¥è¡ŒåŠ¨

### ç«‹å³æ‰§è¡Œï¼ˆ5 åˆ†é’Ÿï¼‰
1. é˜…è¯» `WORKSPACE_ARCHITECTURE.md` ç¬¬ä¹ç« "è¿ç§»æ­¥éª¤"
2. å¤‡ä»½ç°æœ‰ä»£ç ï¼ˆåˆ›å»º Git åˆ†æ”¯ï¼‰
3. å¼€å§‹åˆ›å»º Workspace ç»“æ„

### æ¨èå·¥ä½œæµ
```bash
# 1. åˆ›å»ºå¼€å‘åˆ†æ”¯
git checkout -b workspace-refactor

# 2. æŒ‰ç…§æ–‡æ¡£åˆ›å»ºç»“æ„
# ï¼ˆå‚è€ƒ WORKSPACE_ARCHITECTURE.mdï¼‰

# 3. æ¯å®Œæˆä¸€ä¸ªæ£€æŸ¥ç‚¹å°±æäº¤
git add .
git commit -m "feat(workspace): å®Œæˆæ£€æŸ¥ç‚¹ 1 - Workspace ç»“æ„åˆ›å»º"

# 4. å…¨éƒ¨å®Œæˆååˆå¹¶
git checkout master
git merge workspace-refactor
git tag v0.2.0-workspace
```

---

## ğŸ“ è·å–å¸®åŠ©

### æ–‡æ¡£æŸ¥æ‰¾
- **é¡¹ç›®ç»“æ„é—®é¢˜** â†’ WORKSPACE_ARCHITECTURE.md
- **æ¸¸æˆé€»è¾‘é—®é¢˜** â†’ ARCHITECTURE_BEST_PRACTICE.md
- **å¿«é€ŸæŸ¥è¯¢** â†’ docs/README.md

### ç¤¾åŒºèµ„æº
- [Bevy Discord](https://discord.gg/bevy) - #help é¢‘é“
- [Bevy GitHub Discussions](https://github.com/bevyengine/bevy/discussions)
- [Rust Users Forum](https://users.rust-lang.org/)

---

## âœ… æ€»ç»“

ä½ ç°åœ¨æ‹¥æœ‰ï¼š
1. âœ… å®Œæ•´çš„ Workspace æ¶æ„è®¾è®¡
2. âœ… è¯¦ç»†çš„æ¸¸æˆé€»è¾‘æ¶æ„
3. âœ… æ¸…æ™°çš„å®æ–½è·¯çº¿å›¾
4. âœ… å®Œå–„çš„æ–‡æ¡£ä½“ç³»

**ä¸€åˆ‡å‡†å¤‡å°±ç»ªï¼Œå¼€å§‹å®æ–½å§ï¼ğŸš€**

---

æœ€åæ›´æ–°ï¼š2025-10-19
ç»´æŠ¤è€…ï¼šClaude Code
